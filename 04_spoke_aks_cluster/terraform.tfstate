{
  "version": 4,
  "terraform_version": "1.10.4",
  "serial": 31,
  "lineage": "5adda366-eee3-1e1d-0ec4-68a89021db34",
  "outputs": {
    "latest_version": {
      "value": "1.31.3",
      "type": "string"
    },
    "rg": {
      "value": {
        "name": "rg-lzaks-spoke-aks-cluster"
      },
      "type": [
        "object",
        {
          "name": "string"
        }
      ]
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "azuread_client_config",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azuread\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "93139d1e-a3c1-4d78-9ed5-878be090eba4-04b07795-8ddb-461a-bbee-02f9e1bf7b46-8173c45d-035e-4692-8f40-540cd5fc0f18",
            "object_id": "8173c45d-035e-4692-8f40-540cd5fc0f18",
            "tenant_id": "93139d1e-a3c1-4d78-9ed5-878be090eba4",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azuread_service_principal",
      "name": "aks_aad_server",
      "provider": "provider[\"registry.terraform.io/hashicorp/azuread\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_enabled": true,
            "alternative_names": [],
            "app_role_assignment_required": false,
            "app_role_ids": {},
            "app_roles": [],
            "application_tenant_id": "f8cdef31-a31e-4b4a-93e4-5f571e91255a",
            "client_id": "6dae42f8-4368-4678-94ff-3960e28e3630",
            "description": "",
            "display_name": "Azure Kubernetes Service AAD Server",
            "feature_tags": [
              {
                "custom_single_sign_on": false,
                "enterprise": false,
                "gallery": false,
                "hide": false
              }
            ],
            "features": [
              {
                "custom_single_sign_on_app": false,
                "enterprise_application": false,
                "gallery_application": false,
                "visible_to_users": true
              }
            ],
            "homepage_url": "",
            "id": "/servicePrincipals/29d0a25f-4c41-4196-9461-d76b66455dd1",
            "login_url": "",
            "logout_url": "",
            "notes": "",
            "notification_email_addresses": [],
            "oauth2_permission_scope_ids": {
              "user.read": "34a47c2f-cd0d-47b4-a93c-2c41130c671c"
            },
            "oauth2_permission_scopes": [
              {
                "admin_consent_description": "this allows to read user profile",
                "admin_consent_display_name": "user.read",
                "enabled": true,
                "id": "34a47c2f-cd0d-47b4-a93c-2c41130c671c",
                "type": "User",
                "user_consent_description": "this allows to read user profile",
                "user_consent_display_name": "user.read",
                "value": "user.read"
              }
            ],
            "object_id": "29d0a25f-4c41-4196-9461-d76b66455dd1",
            "preferred_single_sign_on_mode": "",
            "redirect_uris": [],
            "saml_metadata_url": "",
            "saml_single_sign_on": [],
            "service_principal_names": [
              "https://aks-aad-server.azure.com"
            ],
            "sign_in_audience": "AzureADMultipleOrgs",
            "tags": [],
            "timeouts": null,
            "type": "Application"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9ODE3M2M0NWQtMDM1ZS00NjkyLThmNDAtNTQwY2Q1ZmMwZjE4O3N1YnNjcmlwdGlvbklkPWRjZWY3MDA5LTZiOTQtNDM4Mi1hZmRjLTE3ZWIxNjBkNzA5YTt0ZW5hbnRJZD05MzEzOWQxZS1hM2MxLTRkNzgtOWVkNS04NzhiZTA5MGViYTQ=",
            "object_id": "8173c45d-035e-4692-8f40-540cd5fc0f18",
            "subscription_id": "dcef7009-6b94-4382-afdc-17eb160d709a",
            "tenant_id": "93139d1e-a3c1-4d78-9ed5-878be090eba4",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_kubernetes_service_versions",
      "name": "aks",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "default_version": "1.30.7",
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/providers/Microsoft.ContainerService/locations/swedencentral",
            "include_preview": true,
            "latest_version": "1.31.3",
            "location": "swedencentral",
            "timeouts": null,
            "version_prefix": null,
            "versions": [
              "1.31.3",
              "1.31.2",
              "1.31.1",
              "1.30.7",
              "1.30.6",
              "1.30.5",
              "1.30.4",
              "1.30.3",
              "1.30.2",
              "1.30.1",
              "1.30.0",
              "1.29.11",
              "1.29.10",
              "1.29.9",
              "1.29.8",
              "1.29.7",
              "1.29.6",
              "1.29.5",
              "1.29.4",
              "1.29.2",
              "1.29.0",
              "1.28.15",
              "1.28.14",
              "1.28.13",
              "1.28.12",
              "1.28.11",
              "1.28.10",
              "1.28.9",
              "1.28.5",
              "1.28.3",
              "1.28.0"
            ]
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_subscription",
      "name": "subscription_spoke",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "display_name": "ME-MngEnvMCAP784683-hodellai-1",
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a",
            "location_placement_id": "Internal_2014-09-01",
            "quota_id": "Internal_2014-09-01",
            "spending_limit": "Off",
            "state": "Enabled",
            "subscription_id": "dcef7009-6b94-4382-afdc-17eb160d709a",
            "tags": {
              "Division": "Core",
              "Environment": "Hybrid",
              "Purpose": "UserTenant",
              "TimeZone": "_P29145_France_444350001"
            },
            "tenant_id": "93139d1e-a3c1-4d78-9ed5-878be090eba4",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "http",
      "name": "machine_ip",
      "provider": "provider[\"registry.terraform.io/hashicorp/http\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "body": "167.220.196.12",
            "ca_cert_pem": null,
            "id": "http://ifconfig.me",
            "insecure": null,
            "method": null,
            "request_body": null,
            "request_headers": {
              "Accept": "application/json"
            },
            "request_timeout_ms": null,
            "response_body": "167.220.196.12",
            "response_body_base64": "MTY3LjIyMC4xOTYuMTI=",
            "response_headers": {
              "Access-Control-Allow-Origin": "*",
              "Content-Length": "14",
              "Content-Type": "text/plain",
              "Date": "Fri, 17 Jan 2025 15:42:05 GMT",
              "Via": "1.1 google"
            },
            "retry": null,
            "status_code": 200,
            "url": "http://ifconfig.me"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "terraform_remote_state",
      "name": "hub",
      "provider": "provider[\"terraform.io/builtin/terraform\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "backend": "local",
            "config": {
              "value": {
                "path": "../02_hub/terraform.tfstate"
              },
              "type": [
                "object",
                {
                  "path": "string"
                }
              ]
            },
            "defaults": null,
            "outputs": {
              "value": {
                "dns_zone_apps": {
                  "name": "apps.houssem17.com",
                  "resource_group_name": "rg-lzaks-hub-swc"
                },
                "firewall": {
                  "enabled": true,
                  "policy_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-hub-swc/providers/Microsoft.Network/firewallPolicies/firewall-policy",
                  "private_ip": "172.16.0.4"
                },
                "vnet_hub": {
                  "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-hub-swc/providers/Microsoft.Network/virtualNetworks/vnet-hub"
                }
              },
              "type": [
                "object",
                {
                  "dns_zone_apps": [
                    "object",
                    {
                      "name": "string",
                      "resource_group_name": "string"
                    }
                  ],
                  "firewall": [
                    "object",
                    {
                      "enabled": "bool",
                      "policy_id": "string",
                      "private_ip": "string"
                    }
                  ],
                  "vnet_hub": [
                    "object",
                    {
                      "id": "string"
                    }
                  ]
                }
              ]
            },
            "workspace": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "terraform_remote_state",
      "name": "management",
      "provider": "provider[\"terraform.io/builtin/terraform\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "backend": "local",
            "config": {
              "value": {
                "path": "../01_management/terraform.tfstate"
              },
              "type": [
                "object",
                {
                  "path": "string"
                }
              ]
            },
            "defaults": null,
            "outputs": {
              "value": {
                "log_analytics_workspace": {
                  "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-management/providers/Microsoft.OperationalInsights/workspaces/loganalyticsforaks011",
                  "location": "swedencentral",
                  "workspace_id": "536cdf18-5dc0-44a9-872a-988147b34ec1"
                }
              },
              "type": [
                "object",
                {
                  "log_analytics_workspace": [
                    "object",
                    {
                      "id": "string",
                      "location": "string",
                      "workspace_id": "string"
                    }
                  ]
                }
              ]
            },
            "workspace": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "terraform_remote_state",
      "name": "spoke_aks",
      "provider": "provider[\"terraform.io/builtin/terraform\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "backend": "local",
            "config": {
              "value": {
                "path": "../03_spoke_aks_infra/terraform.tfstate"
              },
              "type": [
                "object",
                {
                  "path": "string"
                }
              ]
            },
            "defaults": null,
            "outputs": {
              "value": {
                "acr": {
                  "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.ContainerRegistry/registries/acrforakstf01357"
                },
                "application_gateway": {
                  "enabled": false,
                  "id": null
                },
                "dns_zone_apps": {
                  "fqdn": null
                },
                "grafana": {
                  "dns_url": "grafana-123579-ccb6adhtbdbzf9g0.cse.grafana.azure.com",
                  "endpoint": "https://grafana-123579-ccb6adhtbdbzf9g0.cse.grafana.azure.com",
                  "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Dashboard/grafana/grafana-123579"
                },
                "prometheus": {
                  "data_collection_endpoint_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Insights/dataCollectionEndpoints/prometheus-data-collection-endpoint",
                  "data_collection_rule_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Insights/dataCollectionRules/prometheus-data-collection-rule",
                  "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Monitor/accounts/monitor-workspace-prometheus"
                },
                "route_table": {
                  "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/routeTables/route-table-to-firewall"
                },
                "vnet_spoke_aks": {
                  "address_space": [
                    "10.1.0.0/16"
                  ],
                  "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks",
                  "resource_group_name": "rg-lzaks-spoke-aks-infra",
                  "virtual_network_name": "vnet-spoke-aks"
                }
              },
              "type": [
                "object",
                {
                  "acr": [
                    "object",
                    {
                      "id": "string"
                    }
                  ],
                  "application_gateway": [
                    "object",
                    {
                      "enabled": "bool",
                      "id": "dynamic"
                    }
                  ],
                  "dns_zone_apps": [
                    "object",
                    {
                      "fqdn": "dynamic"
                    }
                  ],
                  "grafana": [
                    "object",
                    {
                      "dns_url": "string",
                      "endpoint": "string",
                      "id": "string"
                    }
                  ],
                  "prometheus": [
                    "object",
                    {
                      "data_collection_endpoint_id": "string",
                      "data_collection_rule_id": "string",
                      "id": "string"
                    }
                  ],
                  "route_table": [
                    "object",
                    {
                      "id": "string"
                    }
                  ],
                  "vnet_spoke_aks": [
                    "object",
                    {
                      "address_space": [
                        "set",
                        "string"
                      ],
                      "id": "string",
                      "resource_group_name": "string",
                      "virtual_network_name": "string"
                    }
                  ]
                }
              ]
            },
            "workspace": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azuread_group",
      "name": "aks_admins",
      "provider": "provider[\"registry.terraform.io/hashicorp/azuread\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 1,
          "attributes": {
            "administrative_unit_ids": [],
            "assignable_to_role": false,
            "auto_subscribe_new_members": false,
            "behaviors": [],
            "description": "",
            "display_name": "aad_group_aks_admins",
            "dynamic_membership": [],
            "external_senders_allowed": false,
            "hide_from_address_lists": false,
            "hide_from_outlook_clients": false,
            "id": "/groups/ba3c20fc-5abc-4807-8725-9ce08e26e829",
            "mail": "",
            "mail_enabled": false,
            "mail_nickname": "bab33022-9",
            "members": [
              "8173c45d-035e-4692-8f40-540cd5fc0f18"
            ],
            "object_id": "ba3c20fc-5abc-4807-8725-9ce08e26e829",
            "onpremises_domain_name": "",
            "onpremises_group_type": "",
            "onpremises_netbios_name": "",
            "onpremises_sam_account_name": "",
            "onpremises_security_identifier": "",
            "onpremises_sync_enabled": false,
            "owners": [
              "8173c45d-035e-4692-8f40-540cd5fc0f18"
            ],
            "preferred_language": "",
            "prevent_duplicate_names": false,
            "provisioning_options": [],
            "proxy_addresses": [],
            "security_enabled": true,
            "theme": "",
            "timeouts": null,
            "types": [],
            "visibility": "",
            "writeback_enabled": false
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjMwMDAwMDAwMDAwMCwicmVhZCI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjEyMDAwMDAwMDAwMDB9LCJzY2hlbWFfdmVyc2lvbiI6IjEifQ==",
          "dependencies": [
            "data.azuread_client_config.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_kubernetes_cluster_extension",
      "name": "extension_flux",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_kubernetes_cluster_node_pool",
      "name": "poolspot",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_kubernetes_flux_configuration",
      "name": "flux_config",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_monitor_alert_prometheus_rule_group",
      "name": "example_k8s",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cluster_name": "aks-cluster",
            "description": "",
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.AlertsManagement/prometheusRuleGroups/KubernetesRecordingRulesRuleGroup",
            "interval": "PT1M",
            "location": "swedencentral",
            "name": "KubernetesRecordingRulesRuleGroup",
            "resource_group_name": "rg-lzaks-spoke-aks-cluster",
            "rule": [
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum by (cluster, namespace, pod, container) (irate(container_cpu_usage_seconds_total{job=\"cadvisor\", image!=\"\"}[5m])) * on (cluster, namespace, pod) group_left(node) topk by (cluster, namespace, pod) (1, max by(cluster, namespace, pod, node) (kube_pod_info{node!=\"\"}))",
                "for": "",
                "labels": {},
                "record": "node_namespace_pod_container:container_cpu_usage_seconds_total:sum_irate",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "container_memory_working_set_bytes{job=\"cadvisor\", image!=\"\"}* on (namespace, pod) group_left(node) topk by(namespace, pod) (1, max by(namespace, pod, node) (kube_pod_info{node!=\"\"}))",
                "for": "",
                "labels": {},
                "record": "node_namespace_pod_container:container_memory_working_set_bytes",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "container_memory_rss{job=\"cadvisor\", image!=\"\"}* on (namespace, pod) group_left(node) topk by(namespace, pod) (1, max by(namespace, pod, node) (kube_pod_info{node!=\"\"}))",
                "for": "",
                "labels": {},
                "record": "node_namespace_pod_container:container_memory_rss",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "container_memory_cache{job=\"cadvisor\", image!=\"\"}* on (namespace, pod) group_left(node) topk by(namespace, pod) (1, max by(namespace, pod, node) (kube_pod_info{node!=\"\"}))",
                "for": "",
                "labels": {},
                "record": "node_namespace_pod_container:container_memory_cache",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "container_memory_swap{job=\"cadvisor\", image!=\"\"}* on (namespace, pod) group_left(node) topk by(namespace, pod) (1, max by(namespace, pod, node) (kube_pod_info{node!=\"\"}))",
                "for": "",
                "labels": {},
                "record": "node_namespace_pod_container:container_memory_swap",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "kube_pod_container_resource_requests{resource=\"memory\",job=\"kube-state-metrics\"} * on(namespace, pod, cluster)group_left() max by (namespace, pod, cluster) ((kube_pod_status_phase{phase=~\"Pending|Running\"} == 1))",
                "for": "",
                "labels": {},
                "record": "cluster:namespace:pod_memory:active:kube_pod_container_resource_requests",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum by (namespace, cluster) (sum by (namespace, pod, cluster) (max by (namespace, pod, container, cluster) (kube_pod_container_resource_requests{resource=\"memory\",job=\"kube-state-metrics\"}) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (kube_pod_status_phase{phase=~\"Pending|Running\"} == 1)))",
                "for": "",
                "labels": {},
                "record": "namespace_memory:kube_pod_container_resource_requests:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "kube_pod_container_resource_requests{resource=\"cpu\",job=\"kube-state-metrics\"} * on (namespace, pod, cluster)group_left() max by (namespace, pod, cluster) ((kube_pod_status_phase{phase=~\"Pending|Running\"} == 1))",
                "for": "",
                "labels": {},
                "record": "cluster:namespace:pod_cpu:active:kube_pod_container_resource_requests",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum by (namespace, cluster) (sum by(namespace, pod, cluster) (max by(namespace, pod, container, cluster) (kube_pod_container_resource_requests{resource=\"cpu\",job=\"kube-state-metrics\"}) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (kube_pod_status_phase{phase=~\"Pending|Running\"} == 1)))",
                "for": "",
                "labels": {},
                "record": "namespace_cpu:kube_pod_container_resource_requests:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "kube_pod_container_resource_limits{resource=\"memory\",job=\"kube-state-metrics\"} * on (namespace, pod, cluster)group_left() max by (namespace, pod, cluster) ((kube_pod_status_phase{phase=~\"Pending|Running\"} == 1))",
                "for": "",
                "labels": {},
                "record": "cluster:namespace:pod_memory:active:kube_pod_container_resource_limits",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum by (namespace, cluster) (sum by (namespace, pod, cluster) (max by (namespace, pod, container, cluster) (kube_pod_container_resource_limits{resource=\"memory\",job=\"kube-state-metrics\"}) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (kube_pod_status_phase{phase=~\"Pending|Running\"} == 1)))",
                "for": "",
                "labels": {},
                "record": "namespace_memory:kube_pod_container_resource_limits:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "kube_pod_container_resource_limits{resource=\"cpu\",job=\"kube-state-metrics\"} * on (namespace, pod, cluster)group_left() max by (namespace, pod, cluster) ( (kube_pod_status_phase{phase=~\"Pending|Running\"} == 1) )",
                "for": "",
                "labels": {},
                "record": "cluster:namespace:pod_cpu:active:kube_pod_container_resource_limits",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum by (namespace, cluster) (sum by (namespace, pod, cluster) (max by(namespace, pod, container, cluster) (kube_pod_container_resource_limits{resource=\"cpu\",job=\"kube-state-metrics\"}) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (kube_pod_status_phase{phase=~\"Pending|Running\"} == 1)))",
                "for": "",
                "labels": {},
                "record": "namespace_cpu:kube_pod_container_resource_limits:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "max by (cluster, namespace, workload, pod) (label_replace(label_replace(kube_pod_owner{job=\"kube-state-metrics\", owner_kind=\"ReplicaSet\"}, \"replicaset\", \"$1\", \"owner_name\", \"(.*)\") * on(replicaset, namespace) group_left(owner_name) topk by(replicaset, namespace) (1, max by (replicaset, namespace, owner_name) (kube_replicaset_owner{job=\"kube-state-metrics\"})), \"workload\", \"$1\", \"owner_name\", \"(.*)\"))",
                "for": "",
                "labels": {
                  "workload_type": "deployment"
                },
                "record": "namespace_workload_pod:kube_pod_owner:relabel",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "max by (cluster, namespace, workload, pod) (label_replace(kube_pod_owner{job=\"kube-state-metrics\", owner_kind=\"DaemonSet\"}, \"workload\", \"$1\", \"owner_name\", \"(.*)\"))",
                "for": "",
                "labels": {
                  "workload_type": "daemonset"
                },
                "record": "namespace_workload_pod:kube_pod_owner:relabel",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "max by (cluster, namespace, workload, pod) (label_replace(kube_pod_owner{job=\"kube-state-metrics\", owner_kind=\"StatefulSet\"}, \"workload\", \"$1\", \"owner_name\", \"(.*)\"))",
                "for": "",
                "labels": {
                  "workload_type": "statefulset"
                },
                "record": "namespace_workload_pod:kube_pod_owner:relabel",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "max by (cluster, namespace, workload, pod) (label_replace(kube_pod_owner{job=\"kube-state-metrics\", owner_kind=\"Job\"}, \"workload\", \"$1\", \"owner_name\", \"(.*)\"))",
                "for": "",
                "labels": {
                  "workload_type": "job"
                },
                "record": "namespace_workload_pod:kube_pod_owner:relabel",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum(node_memory_MemAvailable_bytes{job=\"node\"} or (node_memory_Buffers_bytes{job=\"node\"} + node_memory_Cached_bytes{job=\"node\"} + node_memory_MemFree_bytes{job=\"node\"} + node_memory_Slab_bytes{job=\"node\"})) by (cluster)",
                "for": "",
                "labels": {},
                "record": ":node_memory_MemAvailable_bytes:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum(rate(node_cpu_seconds_total{job=\"node\",mode!=\"idle\",mode!=\"iowait\",mode!=\"steal\"}[5m])) by (cluster) /count(sum(node_cpu_seconds_total{job=\"node\"}) by (cluster, instance, cpu)) by (cluster)",
                "for": "",
                "labels": {},
                "record": "cluster:node_cpu:ratio_rate5m",
                "severity": 0
              }
            ],
            "rule_group_enabled": true,
            "scopes": [
              "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Monitor/accounts/monitor-workspace-prometheus"
            ],
            "tags": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azuread_group.aks_admins",
            "azurerm_kubernetes_cluster.aks",
            "azurerm_private_dns_zone.private_dns_zone_aks",
            "azurerm_resource_group.rg",
            "azurerm_subnet.subnet_nodes_user_nodepool",
            "azurerm_subnet.subnet_pods_user_nodepool",
            "azurerm_subnet.subnet_system_nodes",
            "azurerm_subnet.subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_pods",
            "azurerm_user_assigned_identity.identity-kubelet",
            "azurerm_user_assigned_identity.identity_aks",
            "data.azuread_client_config.current",
            "data.azurerm_subscription.subscription_spoke",
            "data.terraform_remote_state.management",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_monitor_alert_prometheus_rule_group",
      "name": "example_node",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cluster_name": "aks-cluster",
            "description": "",
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.AlertsManagement/prometheusRuleGroups/NodeRecordingRulesRuleGroup",
            "interval": "PT1M",
            "location": "swedencentral",
            "name": "NodeRecordingRulesRuleGroup",
            "resource_group_name": "rg-lzaks-spoke-aks-cluster",
            "rule": [
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "count without (cpu, mode) (node_cpu_seconds_total{job=\"node\",mode=\"idle\"})",
                "for": "",
                "labels": {},
                "record": "instance:node_num_cpu:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "1 - avg without (cpu) (sum without (mode) (rate(node_cpu_seconds_total{job=\"node\", mode=~\"idle|iowait|steal\"}[5m])))",
                "for": "",
                "labels": {},
                "record": "instance:node_cpu_utilisation:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "(node_load1{job=\"node\"}/  instance:node_num_cpu:sum{job=\"node\"})",
                "for": "",
                "labels": {},
                "record": "instance:node_load1_per_cpu:ratio",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "1 - ((node_memory_MemAvailable_bytes{job=\"node\"} or (node_memory_Buffers_bytes{job=\"node\"} + node_memory_Cached_bytes{job=\"node\"} + node_memory_MemFree_bytes{job=\"node\"} + node_memory_Slab_bytes{job=\"node\"})) / node_memory_MemTotal_bytes{job=\"node\"})",
                "for": "",
                "labels": {},
                "record": "instance:node_memory_utilisation:ratio",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "rate(node_vmstat_pgmajfault{job=\"node\"}[5m])",
                "for": "",
                "labels": {},
                "record": "instance:node_vmstat_pgmajfault:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "rate(node_disk_io_time_seconds_total{job=\"node\", device!=\"\"}[5m])",
                "for": "",
                "labels": {},
                "record": "instance_device:node_disk_io_time_seconds:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "rate(node_disk_io_time_weighted_seconds_total{job=\"node\", device!=\"\"}[5m])",
                "for": "",
                "labels": {},
                "record": "instance_device:node_disk_io_time_weighted_seconds:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum without (device) (rate(node_network_receive_bytes_total{job=\"node\", device!=\"lo\"}[5m]))",
                "for": "",
                "labels": {},
                "record": "instance:node_network_receive_bytes_excluding_lo:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum without (device) (rate(node_network_transmit_bytes_total{job=\"node\", device!=\"lo\"}[5m]))",
                "for": "",
                "labels": {},
                "record": "instance:node_network_transmit_bytes_excluding_lo:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum without (device) (rate(node_network_receive_drop_total{job=\"node\", device!=\"lo\"}[5m]))",
                "for": "",
                "labels": {},
                "record": "instance:node_network_receive_drop_excluding_lo:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum without (device) (rate(node_network_transmit_drop_total{job=\"node\", device!=\"lo\"}[5m]))",
                "for": "",
                "labels": {},
                "record": "instance:node_network_transmit_drop_excluding_lo:rate5m",
                "severity": 0
              }
            ],
            "rule_group_enabled": true,
            "scopes": [
              "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Monitor/accounts/monitor-workspace-prometheus"
            ],
            "tags": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azuread_group.aks_admins",
            "azurerm_kubernetes_cluster.aks",
            "azurerm_private_dns_zone.private_dns_zone_aks",
            "azurerm_resource_group.rg",
            "azurerm_subnet.subnet_nodes_user_nodepool",
            "azurerm_subnet.subnet_pods_user_nodepool",
            "azurerm_subnet.subnet_system_nodes",
            "azurerm_subnet.subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_pods",
            "azurerm_user_assigned_identity.identity-kubelet",
            "azurerm_user_assigned_identity.identity_aks",
            "data.azuread_client_config.current",
            "data.azurerm_subscription.subscription_spoke",
            "data.terraform_remote_state.management",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_private_dns_zone",
      "name": "private_dns_zone_aks",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_private_dns_zone_virtual_network_link",
      "name": "link_private_dns_zone_aks_to_vnet_hub",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "rg",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-cluster",
            "location": "swedencentral",
            "managed_by": "",
            "name": "rg-lzaks-spoke-aks-cluster",
            "tags": {
              "architecture": "Hub\u0026Spoke",
              "environment": "development",
              "source": "terraform"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_acrpull",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.ContainerRegistry/registries/acrforakstf01357/providers/Microsoft.Authorization/roleAssignments/f601885b-0ea7-e863-b9d2-3c2106d8ce55",
            "name": "f601885b-0ea7-e863-b9d2-3c2106d8ce55",
            "principal_id": "4d61f477-fb48-442d-b197-5ac86df64583",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/providers/Microsoft.Authorization/roleDefinitions/7f951dda-4ed3-4680-a7ca-43fe172d538d",
            "role_definition_name": "AcrPull",
            "scope": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.ContainerRegistry/registries/acrforakstf01357",
            "skip_service_principal_aad_check": true,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "azurerm_resource_group.rg",
            "azurerm_user_assigned_identity.identity-kubelet",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_appgw_contributor",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_appgw_network_contributor",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_appgw_reader",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_identity_aks_contributor",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.Authorization/roleAssignments/0fac780f-c326-e6a5-00cf-98d6625eaa98",
            "name": "0fac780f-c326-e6a5-00cf-98d6625eaa98",
            "principal_id": "a53aaaac-ba81-4446-a0cd-a2e85b43a672",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-cluster",
            "skip_service_principal_aad_check": true,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "azurerm_resource_group.rg",
            "azurerm_user_assigned_identity.identity_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_identity_aks_contributor_routetable",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_identity_aks_mi_operator",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.ManagedIdentity/userAssignedIdentities/identity-kubelet/providers/Microsoft.Authorization/roleAssignments/25909e8f-93a2-cd98-5f46-38922e655a50",
            "name": "25909e8f-93a2-cd98-5f46-38922e655a50",
            "principal_id": "a53aaaac-ba81-4446-a0cd-a2e85b43a672",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/providers/Microsoft.Authorization/roleDefinitions/f1a07417-d97a-45cb-824c-7a7467783830",
            "role_definition_name": "Managed Identity Operator",
            "scope": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.ManagedIdentity/userAssignedIdentities/identity-kubelet",
            "skip_service_principal_aad_check": true,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "azurerm_resource_group.rg",
            "azurerm_user_assigned_identity.identity-kubelet",
            "azurerm_user_assigned_identity.identity_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_identity_aks_network_contributor",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/providers/Microsoft.Authorization/roleAssignments/3b935ade-ba3b-6078-cc99-581f5ba53b9d",
            "name": "3b935ade-ba3b-6078-cc99-581f5ba53b9d",
            "principal_id": "a53aaaac-ba81-4446-a0cd-a2e85b43a672",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
            "role_definition_name": "Network Contributor",
            "scope": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks",
            "skip_service_principal_aad_check": true,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "azurerm_resource_group.rg",
            "azurerm_user_assigned_identity.identity_aks",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_identity_aks_network_contributor_subnet_apiserver",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_private_dns_zone_aks_contributor",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_apiserver",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_nodes_user_nodepool",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "poolappsamd",
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.1.7.0/24"
            ],
            "default_outbound_access_enabled": true,
            "delegation": [],
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes-poolappsamd",
            "name": "subnet-nodes-poolappsamd",
            "private_endpoint_network_policies": "Disabled",
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "rg-lzaks-spoke-aks-infra",
            "service_endpoint_policy_ids": [],
            "service_endpoints": [],
            "timeouts": null,
            "virtual_network_name": "vnet-spoke-aks"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_nodes_user_nodepool_spot",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_pods_user_nodepool",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "poolappsamd",
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.1.8.0/24"
            ],
            "default_outbound_access_enabled": true,
            "delegation": [
              {
                "name": "Microsoft.ContainerService.managedClusters",
                "service_delegation": [
                  {
                    "actions": [
                      "Microsoft.Network/virtualNetworks/subnets/join/action"
                    ],
                    "name": "Microsoft.ContainerService/managedClusters"
                  }
                ]
              }
            ],
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods-poolappsamd",
            "name": "subnet-pods-poolappsamd",
            "private_endpoint_network_policies": "Disabled",
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "rg-lzaks-spoke-aks-infra",
            "service_endpoint_policy_ids": [],
            "service_endpoints": [],
            "timeouts": null,
            "virtual_network_name": "vnet-spoke-aks"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_pods_user_nodepool_spot",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_system_nodes",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.1.3.0/24"
            ],
            "default_outbound_access_enabled": true,
            "delegation": [],
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes",
            "name": "subnet-nodes",
            "private_endpoint_network_policies": "Disabled",
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "rg-lzaks-spoke-aks-infra",
            "service_endpoint_policy_ids": [],
            "service_endpoints": [],
            "timeouts": null,
            "virtual_network_name": "vnet-spoke-aks"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_system_pods",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.1.240.0/20"
            ],
            "default_outbound_access_enabled": true,
            "delegation": [
              {
                "name": "Microsoft.ContainerService.managedClusters",
                "service_delegation": [
                  {
                    "actions": [
                      "Microsoft.Network/virtualNetworks/subnets/join/action"
                    ],
                    "name": "Microsoft.ContainerService/managedClusters"
                  }
                ]
              }
            ],
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods",
            "name": "subnet-pods",
            "private_endpoint_network_policies": "Disabled",
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "rg-lzaks-spoke-aks-infra",
            "service_endpoint_policy_ids": [],
            "service_endpoints": [],
            "timeouts": null,
            "virtual_network_name": "vnet-spoke-aks"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet_route_table_association",
      "name": "association_rt_subnet_system_nodes",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes",
            "route_table_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/routeTables/route-table-to-firewall",
            "subnet_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "azurerm_subnet.subnet_system_nodes",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet_route_table_association",
      "name": "association_rt_subnet_system_pods",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods",
            "route_table_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/routeTables/route-table-to-firewall",
            "subnet_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "azurerm_subnet.subnet_system_pods",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet_route_table_association",
      "name": "association_rt_subnet_user_nodes",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "poolappsamd",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes-poolappsamd",
            "route_table_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/routeTables/route-table-to-firewall",
            "subnet_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes-poolappsamd",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "azurerm_subnet.subnet_nodes_user_nodepool",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet_route_table_association",
      "name": "association_rt_subnet_user_pods",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "poolappsamd",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods-poolappsamd",
            "route_table_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/routeTables/route-table-to-firewall",
            "subnet_id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods-poolappsamd",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "azurerm_subnet.subnet_pods_user_nodepool",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_user_assigned_identity",
      "name": "identity-kubelet",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "client_id": "e24db1cd-4054-4b9b-bf15-d07154a4a245",
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.ManagedIdentity/userAssignedIdentities/identity-kubelet",
            "location": "swedencentral",
            "name": "identity-kubelet",
            "principal_id": "4d61f477-fb48-442d-b197-5ac86df64583",
            "resource_group_name": "rg-lzaks-spoke-aks-cluster",
            "tags": {
              "architecture": "Hub\u0026Spoke",
              "environment": "development",
              "source": "terraform"
            },
            "tenant_id": "93139d1e-a3c1-4d78-9ed5-878be090eba4",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "azurerm_resource_group.rg"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_user_assigned_identity",
      "name": "identity_aks",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "client_id": "f7b0bf81-e198-4a40-b9cb-34cb245bc410",
            "id": "/subscriptions/dcef7009-6b94-4382-afdc-17eb160d709a/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.ManagedIdentity/userAssignedIdentities/identity-aks",
            "location": "swedencentral",
            "name": "identity-aks",
            "principal_id": "a53aaaac-ba81-4446-a0cd-a2e85b43a672",
            "resource_group_name": "rg-lzaks-spoke-aks-cluster",
            "tags": {
              "architecture": "Hub\u0026Spoke",
              "environment": "development",
              "source": "terraform"
            },
            "tenant_id": "93139d1e-a3c1-4d78-9ed5-878be090eba4",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "azurerm_resource_group.rg"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "null_resource",
      "name": "connect_to_aks",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "3710436836817914733",
            "triggers": {
              "key": "value2"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "azuread_group.aks_admins",
            "azurerm_kubernetes_cluster.aks",
            "azurerm_kubernetes_cluster_node_pool.poolapps",
            "azurerm_kubernetes_cluster_node_pool.poolspot",
            "azurerm_private_dns_zone.private_dns_zone_aks",
            "azurerm_resource_group.rg",
            "azurerm_subnet.subnet_nodes_user_nodepool",
            "azurerm_subnet.subnet_nodes_user_nodepool_spot",
            "azurerm_subnet.subnet_pods_user_nodepool",
            "azurerm_subnet.subnet_pods_user_nodepool_spot",
            "azurerm_subnet.subnet_system_nodes",
            "azurerm_subnet.subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_pods",
            "azurerm_user_assigned_identity.identity-kubelet",
            "azurerm_user_assigned_identity.identity_aks",
            "data.azuread_client_config.current",
            "data.azurerm_subscription.subscription_spoke",
            "data.terraform_remote_state.management",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
