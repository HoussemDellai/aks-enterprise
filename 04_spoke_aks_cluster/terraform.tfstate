{
  "version": 4,
  "terraform_version": "1.5.5",
  "serial": 446,
  "lineage": "e8a857e2-f4d9-feb4-7a63-e9f2b377d803",
  "outputs": {
    "latest_version": {
      "value": "1.27.3",
      "type": "string"
    },
    "rg": {
      "value": {
        "name": "rg-lzaks-spoke-aks-cluster"
      },
      "type": [
        "object",
        {
          "name": "string"
        }
      ]
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "azuread_client_config",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azuread\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "16b3c013-d300-468d-ac64-7eda0820b6d3-04b07795-8ddb-461a-bbee-02f9e1bf7b46-99b281c9-823c-4633-af92-8ac556a19bee",
            "object_id": "99b281c9-823c-4633-af92-8ac556a19bee",
            "tenant_id": "16b3c013-d300-468d-ac64-7eda0820b6d3",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azuread_service_principal",
      "name": "aks_aad_server",
      "provider": "provider[\"registry.terraform.io/hashicorp/azuread\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_enabled": true,
            "alternative_names": [],
            "app_role_assignment_required": false,
            "app_role_ids": {},
            "app_roles": [],
            "application_id": "6dae42f8-4368-4678-94ff-3960e28e3630",
            "application_tenant_id": "f8cdef31-a31e-4b4a-93e4-5f571e91255a",
            "description": "",
            "display_name": "Azure Kubernetes Service AAD Server",
            "feature_tags": [
              {
                "custom_single_sign_on": false,
                "enterprise": false,
                "gallery": false,
                "hide": false
              }
            ],
            "features": [
              {
                "custom_single_sign_on_app": false,
                "enterprise_application": false,
                "gallery_application": false,
                "visible_to_users": true
              }
            ],
            "homepage_url": "",
            "id": "87d6543d-05f4-4985-8f51-cfbe152ee0cc",
            "login_url": "",
            "logout_url": "",
            "notes": "",
            "notification_email_addresses": [],
            "oauth2_permission_scope_ids": {
              "user.read": "34a47c2f-cd0d-47b4-a93c-2c41130c671c"
            },
            "oauth2_permission_scopes": [
              {
                "admin_consent_description": "this allows to read user profile",
                "admin_consent_display_name": "user.read",
                "enabled": true,
                "id": "34a47c2f-cd0d-47b4-a93c-2c41130c671c",
                "type": "User",
                "user_consent_description": "this allows to read user profile",
                "user_consent_display_name": "user.read",
                "value": "user.read"
              }
            ],
            "object_id": "87d6543d-05f4-4985-8f51-cfbe152ee0cc",
            "preferred_single_sign_on_mode": "",
            "redirect_uris": [],
            "saml_metadata_url": "",
            "saml_single_sign_on": [],
            "service_principal_names": [
              "https://aks-aad-server.azure.com"
            ],
            "sign_in_audience": "AzureADMultipleOrgs",
            "tags": [],
            "timeouts": null,
            "type": "Application"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9OTliMjgxYzktODIzYy00NjMzLWFmOTItOGFjNTU2YTE5YmVlO3N1YnNjcmlwdGlvbklkPTgyZjZkNzVlLTg1ZjQtNDM0YS1hYjc0LTVkZGRkOWZhODkxMDt0ZW5hbnRJZD0xNmIzYzAxMy1kMzAwLTQ2OGQtYWM2NC03ZWRhMDgyMGI2ZDM=",
            "object_id": "99b281c9-823c-4633-af92-8ac556a19bee",
            "subscription_id": "82f6d75e-85f4-434a-ab74-5dddd9fa8910",
            "tenant_id": "16b3c013-d300-468d-ac64-7eda0820b6d3",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_kubernetes_service_versions",
      "name": "aks",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/providers/Microsoft.ContainerService/locations/westeurope",
            "include_preview": true,
            "latest_version": "1.27.3",
            "location": "westeurope",
            "timeouts": null,
            "version_prefix": null,
            "versions": [
              "1.25.6",
              "1.25.11",
              "1.26.3",
              "1.26.6",
              "1.27.1",
              "1.27.3"
            ]
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "azurerm_subscription",
      "name": "subscription_spoke",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "display_name": "Microsoft-Azure-NonProd",
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910",
            "location_placement_id": "Internal_2014-09-01",
            "quota_id": "Internal_2014-09-01",
            "spending_limit": "Off",
            "state": "Enabled",
            "subscription_id": "82f6d75e-85f4-434a-ab74-5dddd9fa8910",
            "tags": {
              "tag1": "MCAPS-Hybrid-REQ-46246-2022-HoussemDellai",
              "tag2": "Hybrid"
            },
            "tenant_id": "16b3c013-d300-468d-ac64-7eda0820b6d3",
            "timeouts": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "http",
      "name": "machine_ip",
      "provider": "provider[\"registry.terraform.io/hashicorp/http\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "body": "176.177.25.47",
            "ca_cert_pem": null,
            "id": "http://ifconfig.me",
            "insecure": null,
            "method": null,
            "request_body": null,
            "request_headers": {
              "Accept": "application/json"
            },
            "request_timeout_ms": null,
            "response_body": "176.177.25.47",
            "response_body_base64": "MTc2LjE3Ny4yNS40Nw==",
            "response_headers": {
              "Access-Control-Allow-Origin": "*",
              "Content-Length": "13",
              "Content-Type": "text/plain; charset=utf-8",
              "Date": "Tue, 15 Aug 2023 12:19:34 GMT",
              "Server": "istio-envoy",
              "Strict-Transport-Security": "max-age=2592000; includeSubDomains",
              "Via": "1.1 google",
              "X-Envoy-Upstream-Service-Time": "1"
            },
            "retry": null,
            "status_code": 200,
            "url": "http://ifconfig.me"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "terraform_remote_state",
      "name": "hub",
      "provider": "provider[\"terraform.io/builtin/terraform\"]",
      "instances": [
        {
          "index_key": 0,
          "schema_version": 0,
          "attributes": {
            "backend": "local",
            "config": {
              "value": {
                "path": "../02_hub/terraform.tfstate"
              },
              "type": [
                "object",
                {
                  "path": "string"
                }
              ]
            },
            "defaults": null,
            "outputs": {
              "value": {
                "dns_zone_apps": {
                  "name": "apps.houssem15.com",
                  "resource_group_name": "rg-lzaks-hub-weu"
                },
                "firewall": {
                  "enabled": true,
                  "policy_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-hub-weu/providers/Microsoft.Network/firewallPolicies/firewall-policy",
                  "private_ip": "172.16.0.4"
                },
                "vnet_hub": {
                  "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-hub-weu/providers/Microsoft.Network/virtualNetworks/vnet-hub"
                }
              },
              "type": [
                "object",
                {
                  "dns_zone_apps": [
                    "object",
                    {
                      "name": "string",
                      "resource_group_name": "string"
                    }
                  ],
                  "firewall": [
                    "object",
                    {
                      "enabled": "bool",
                      "policy_id": "string",
                      "private_ip": "string"
                    }
                  ],
                  "vnet_hub": [
                    "object",
                    {
                      "id": "string"
                    }
                  ]
                }
              ]
            },
            "workspace": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "data",
      "type": "terraform_remote_state",
      "name": "management",
      "provider": "provider[\"terraform.io/builtin/terraform\"]",
      "instances": []
    },
    {
      "mode": "data",
      "type": "terraform_remote_state",
      "name": "spoke_aks",
      "provider": "provider[\"terraform.io/builtin/terraform\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "backend": "local",
            "config": {
              "value": {
                "path": "../03_spoke_aks_infra/terraform.tfstate"
              },
              "type": [
                "object",
                {
                  "path": "string"
                }
              ]
            },
            "defaults": null,
            "outputs": {
              "value": {
                "acr": {
                  "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.ContainerRegistry/registries/acrforakstf01357"
                },
                "application_gateway": {
                  "enabled": false,
                  "id": null
                },
                "dns_zone_apps": {
                  "fqdn": null
                },
                "grafana": {
                  "dns_url": "grafana-123579-dvbtezd6gycyckbc.weu.grafana.azure.com",
                  "endpoint": "https://grafana-123579-dvbtezd6gycyckbc.weu.grafana.azure.com",
                  "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Dashboard/grafana/grafana-123579"
                },
                "prometheus": {
                  "data_collection_endpoint_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Insights/dataCollectionEndpoints/prometheus-data-collection-endpoint",
                  "data_collection_rule_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Insights/dataCollectionRules/prometheus-data-collection-rule",
                  "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Monitor/accounts/monitor-workspace-prometheus"
                },
                "route_table": {
                  "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/routeTables/route-table-to-firewall"
                },
                "vnet_spoke_aks": {
                  "address_space": [
                    "10.1.0.0/16"
                  ],
                  "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks",
                  "resource_group_name": "rg-lzaks-spoke-aks-infra",
                  "virtual_network_name": "vnet-spoke-aks"
                }
              },
              "type": [
                "object",
                {
                  "acr": [
                    "object",
                    {
                      "id": "string"
                    }
                  ],
                  "application_gateway": [
                    "object",
                    {
                      "enabled": "bool",
                      "id": "dynamic"
                    }
                  ],
                  "dns_zone_apps": [
                    "object",
                    {
                      "fqdn": "dynamic"
                    }
                  ],
                  "grafana": [
                    "object",
                    {
                      "dns_url": "string",
                      "endpoint": "string",
                      "id": "string"
                    }
                  ],
                  "prometheus": [
                    "object",
                    {
                      "data_collection_endpoint_id": "string",
                      "data_collection_rule_id": "string",
                      "id": "string"
                    }
                  ],
                  "route_table": [
                    "object",
                    {
                      "id": "string"
                    }
                  ],
                  "vnet_spoke_aks": [
                    "object",
                    {
                      "address_space": [
                        "list",
                        "string"
                      ],
                      "id": "string",
                      "resource_group_name": "string",
                      "virtual_network_name": "string"
                    }
                  ]
                }
              ]
            },
            "workspace": null
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azapi_update_resource",
      "name": "aks_enable_network_observability",
      "provider": "provider[\"registry.terraform.io/azure/azapi\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azuread_group",
      "name": "aks_admins",
      "provider": "provider[\"registry.terraform.io/hashicorp/azuread\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_kubernetes_cluster_node_pool",
      "name": "poolapps",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_kubernetes_cluster_node_pool",
      "name": "poolspot",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_monitor_alert_prometheus_rule_group",
      "name": "example_k8s",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cluster_name": "aks-cluster-dev",
            "description": "",
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.AlertsManagement/prometheusRuleGroups/KubernetesRecordingRulesRuleGroup",
            "interval": "PT1M",
            "location": "westeurope",
            "name": "KubernetesRecordingRulesRuleGroup",
            "resource_group_name": "rg-lzaks-spoke-aks-cluster",
            "rule": [
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum by (cluster, namespace, pod, container) (irate(container_cpu_usage_seconds_total{job=\"cadvisor\", image!=\"\"}[5m])) * on (cluster, namespace, pod) group_left(node) topk by (cluster, namespace, pod) (1, max by(cluster, namespace, pod, node) (kube_pod_info{node!=\"\"}))",
                "for": "",
                "labels": {},
                "record": "node_namespace_pod_container:container_cpu_usage_seconds_total:sum_irate",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "container_memory_working_set_bytes{job=\"cadvisor\", image!=\"\"}* on (namespace, pod) group_left(node) topk by(namespace, pod) (1, max by(namespace, pod, node) (kube_pod_info{node!=\"\"}))",
                "for": "",
                "labels": {},
                "record": "node_namespace_pod_container:container_memory_working_set_bytes",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "container_memory_rss{job=\"cadvisor\", image!=\"\"}* on (namespace, pod) group_left(node) topk by(namespace, pod) (1, max by(namespace, pod, node) (kube_pod_info{node!=\"\"}))",
                "for": "",
                "labels": {},
                "record": "node_namespace_pod_container:container_memory_rss",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "container_memory_cache{job=\"cadvisor\", image!=\"\"}* on (namespace, pod) group_left(node) topk by(namespace, pod) (1, max by(namespace, pod, node) (kube_pod_info{node!=\"\"}))",
                "for": "",
                "labels": {},
                "record": "node_namespace_pod_container:container_memory_cache",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "container_memory_swap{job=\"cadvisor\", image!=\"\"}* on (namespace, pod) group_left(node) topk by(namespace, pod) (1, max by(namespace, pod, node) (kube_pod_info{node!=\"\"}))",
                "for": "",
                "labels": {},
                "record": "node_namespace_pod_container:container_memory_swap",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "kube_pod_container_resource_requests{resource=\"memory\",job=\"kube-state-metrics\"} * on(namespace, pod, cluster)group_left() max by (namespace, pod, cluster) ((kube_pod_status_phase{phase=~\"Pending|Running\"} == 1))",
                "for": "",
                "labels": {},
                "record": "cluster:namespace:pod_memory:active:kube_pod_container_resource_requests",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum by (namespace, cluster) (sum by (namespace, pod, cluster) (max by (namespace, pod, container, cluster) (kube_pod_container_resource_requests{resource=\"memory\",job=\"kube-state-metrics\"}) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (kube_pod_status_phase{phase=~\"Pending|Running\"} == 1)))",
                "for": "",
                "labels": {},
                "record": "namespace_memory:kube_pod_container_resource_requests:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "kube_pod_container_resource_requests{resource=\"cpu\",job=\"kube-state-metrics\"} * on (namespace, pod, cluster)group_left() max by (namespace, pod, cluster) ((kube_pod_status_phase{phase=~\"Pending|Running\"} == 1))",
                "for": "",
                "labels": {},
                "record": "cluster:namespace:pod_cpu:active:kube_pod_container_resource_requests",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum by (namespace, cluster) (sum by(namespace, pod, cluster) (max by(namespace, pod, container, cluster) (kube_pod_container_resource_requests{resource=\"cpu\",job=\"kube-state-metrics\"}) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (kube_pod_status_phase{phase=~\"Pending|Running\"} == 1)))",
                "for": "",
                "labels": {},
                "record": "namespace_cpu:kube_pod_container_resource_requests:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "kube_pod_container_resource_limits{resource=\"memory\",job=\"kube-state-metrics\"} * on (namespace, pod, cluster)group_left() max by (namespace, pod, cluster) ((kube_pod_status_phase{phase=~\"Pending|Running\"} == 1))",
                "for": "",
                "labels": {},
                "record": "cluster:namespace:pod_memory:active:kube_pod_container_resource_limits",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum by (namespace, cluster) (sum by (namespace, pod, cluster) (max by (namespace, pod, container, cluster) (kube_pod_container_resource_limits{resource=\"memory\",job=\"kube-state-metrics\"}) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (kube_pod_status_phase{phase=~\"Pending|Running\"} == 1)))",
                "for": "",
                "labels": {},
                "record": "namespace_memory:kube_pod_container_resource_limits:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "kube_pod_container_resource_limits{resource=\"cpu\",job=\"kube-state-metrics\"} * on (namespace, pod, cluster)group_left() max by (namespace, pod, cluster) ( (kube_pod_status_phase{phase=~\"Pending|Running\"} == 1) )",
                "for": "",
                "labels": {},
                "record": "cluster:namespace:pod_cpu:active:kube_pod_container_resource_limits",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum by (namespace, cluster) (sum by (namespace, pod, cluster) (max by(namespace, pod, container, cluster) (kube_pod_container_resource_limits{resource=\"cpu\",job=\"kube-state-metrics\"}) * on(namespace, pod, cluster) group_left() max by (namespace, pod, cluster) (kube_pod_status_phase{phase=~\"Pending|Running\"} == 1)))",
                "for": "",
                "labels": {},
                "record": "namespace_cpu:kube_pod_container_resource_limits:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "max by (cluster, namespace, workload, pod) (label_replace(label_replace(kube_pod_owner{job=\"kube-state-metrics\", owner_kind=\"ReplicaSet\"}, \"replicaset\", \"$1\", \"owner_name\", \"(.*)\") * on(replicaset, namespace) group_left(owner_name) topk by(replicaset, namespace) (1, max by (replicaset, namespace, owner_name) (kube_replicaset_owner{job=\"kube-state-metrics\"})), \"workload\", \"$1\", \"owner_name\", \"(.*)\"))",
                "for": "",
                "labels": {
                  "workload_type": "deployment"
                },
                "record": "namespace_workload_pod:kube_pod_owner:relabel",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "max by (cluster, namespace, workload, pod) (label_replace(kube_pod_owner{job=\"kube-state-metrics\", owner_kind=\"DaemonSet\"}, \"workload\", \"$1\", \"owner_name\", \"(.*)\"))",
                "for": "",
                "labels": {
                  "workload_type": "daemonset"
                },
                "record": "namespace_workload_pod:kube_pod_owner:relabel",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "max by (cluster, namespace, workload, pod) (label_replace(kube_pod_owner{job=\"kube-state-metrics\", owner_kind=\"StatefulSet\"}, \"workload\", \"$1\", \"owner_name\", \"(.*)\"))",
                "for": "",
                "labels": {
                  "workload_type": "statefulset"
                },
                "record": "namespace_workload_pod:kube_pod_owner:relabel",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "max by (cluster, namespace, workload, pod) (label_replace(kube_pod_owner{job=\"kube-state-metrics\", owner_kind=\"Job\"}, \"workload\", \"$1\", \"owner_name\", \"(.*)\"))",
                "for": "",
                "labels": {
                  "workload_type": "job"
                },
                "record": "namespace_workload_pod:kube_pod_owner:relabel",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum(node_memory_MemAvailable_bytes{job=\"node\"} or (node_memory_Buffers_bytes{job=\"node\"} + node_memory_Cached_bytes{job=\"node\"} + node_memory_MemFree_bytes{job=\"node\"} + node_memory_Slab_bytes{job=\"node\"})) by (cluster)",
                "for": "",
                "labels": {},
                "record": ":node_memory_MemAvailable_bytes:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum(rate(node_cpu_seconds_total{job=\"node\",mode!=\"idle\",mode!=\"iowait\",mode!=\"steal\"}[5m])) by (cluster) /count(sum(node_cpu_seconds_total{job=\"node\"}) by (cluster, instance, cpu)) by (cluster)",
                "for": "",
                "labels": {},
                "record": "cluster:node_cpu:ratio_rate5m",
                "severity": 0
              }
            ],
            "rule_group_enabled": true,
            "scopes": [
              "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Monitor/accounts/monitor-workspace-prometheus"
            ],
            "tags": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azuread_group.aks_admins",
            "azurerm_kubernetes_cluster.aks",
            "azurerm_private_dns_zone.private_dns_zone_aks",
            "azurerm_resource_group.rg",
            "azurerm_subnet.subnet_apiserver",
            "azurerm_subnet.subnet_nodes_user_nodepool",
            "azurerm_subnet.subnet_pods_user_nodepool",
            "azurerm_subnet.subnet_system_nodes",
            "azurerm_subnet.subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_pods",
            "azurerm_user_assigned_identity.identity-kubelet",
            "azurerm_user_assigned_identity.identity_aks",
            "data.azuread_client_config.current",
            "data.azurerm_subscription.subscription_spoke",
            "data.terraform_remote_state.management",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_monitor_alert_prometheus_rule_group",
      "name": "example_node",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "cluster_name": "aks-cluster-dev",
            "description": "",
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.AlertsManagement/prometheusRuleGroups/NodeRecordingRulesRuleGroup",
            "interval": "PT1M",
            "location": "westeurope",
            "name": "NodeRecordingRulesRuleGroup",
            "resource_group_name": "rg-lzaks-spoke-aks-cluster",
            "rule": [
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "count without (cpu, mode) (node_cpu_seconds_total{job=\"node\",mode=\"idle\"})",
                "for": "",
                "labels": {},
                "record": "instance:node_num_cpu:sum",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "1 - avg without (cpu) (sum without (mode) (rate(node_cpu_seconds_total{job=\"node\", mode=~\"idle|iowait|steal\"}[5m])))",
                "for": "",
                "labels": {},
                "record": "instance:node_cpu_utilisation:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "(node_load1{job=\"node\"}/  instance:node_num_cpu:sum{job=\"node\"})",
                "for": "",
                "labels": {},
                "record": "instance:node_load1_per_cpu:ratio",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "1 - ((node_memory_MemAvailable_bytes{job=\"node\"} or (node_memory_Buffers_bytes{job=\"node\"} + node_memory_Cached_bytes{job=\"node\"} + node_memory_MemFree_bytes{job=\"node\"} + node_memory_Slab_bytes{job=\"node\"})) / node_memory_MemTotal_bytes{job=\"node\"})",
                "for": "",
                "labels": {},
                "record": "instance:node_memory_utilisation:ratio",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "rate(node_vmstat_pgmajfault{job=\"node\"}[5m])",
                "for": "",
                "labels": {},
                "record": "instance:node_vmstat_pgmajfault:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "rate(node_disk_io_time_seconds_total{job=\"node\", device!=\"\"}[5m])",
                "for": "",
                "labels": {},
                "record": "instance_device:node_disk_io_time_seconds:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "rate(node_disk_io_time_weighted_seconds_total{job=\"node\", device!=\"\"}[5m])",
                "for": "",
                "labels": {},
                "record": "instance_device:node_disk_io_time_weighted_seconds:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum without (device) (rate(node_network_receive_bytes_total{job=\"node\", device!=\"lo\"}[5m]))",
                "for": "",
                "labels": {},
                "record": "instance:node_network_receive_bytes_excluding_lo:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum without (device) (rate(node_network_transmit_bytes_total{job=\"node\", device!=\"lo\"}[5m]))",
                "for": "",
                "labels": {},
                "record": "instance:node_network_transmit_bytes_excluding_lo:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum without (device) (rate(node_network_receive_drop_total{job=\"node\", device!=\"lo\"}[5m]))",
                "for": "",
                "labels": {},
                "record": "instance:node_network_receive_drop_excluding_lo:rate5m",
                "severity": 0
              },
              {
                "action": [],
                "alert": "",
                "alert_resolution": [],
                "annotations": {},
                "enabled": false,
                "expression": "sum without (device) (rate(node_network_transmit_drop_total{job=\"node\", device!=\"lo\"}[5m]))",
                "for": "",
                "labels": {},
                "record": "instance:node_network_transmit_drop_excluding_lo:rate5m",
                "severity": 0
              }
            ],
            "rule_group_enabled": true,
            "scopes": [
              "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Monitor/accounts/monitor-workspace-prometheus"
            ],
            "tags": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azuread_group.aks_admins",
            "azurerm_kubernetes_cluster.aks",
            "azurerm_private_dns_zone.private_dns_zone_aks",
            "azurerm_resource_group.rg",
            "azurerm_subnet.subnet_apiserver",
            "azurerm_subnet.subnet_nodes_user_nodepool",
            "azurerm_subnet.subnet_pods_user_nodepool",
            "azurerm_subnet.subnet_system_nodes",
            "azurerm_subnet.subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_pods",
            "azurerm_user_assigned_identity.identity-kubelet",
            "azurerm_user_assigned_identity.identity_aks",
            "data.azuread_client_config.current",
            "data.azurerm_subscription.subscription_spoke",
            "data.terraform_remote_state.management",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_monitor_data_collection_rule_association",
      "name": "dce_to_aks",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_monitor_data_collection_rule_association",
      "name": "dcr_to_aks",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_private_dns_zone",
      "name": "private_dns_zone_aks",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_resource_group",
      "name": "rg",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-cluster",
            "location": "westeurope",
            "managed_by": "",
            "name": "rg-lzaks-spoke-aks-cluster",
            "tags": {
              "architecture": "Hub\u0026Spoke",
              "environment": "development",
              "source": "terraform"
            },
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo1NDAwMDAwMDAwMDAwLCJkZWxldGUiOjU0MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjo1NDAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "current_user_aks_admin",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_acrpull",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.ContainerRegistry/registries/acrforakstf01357/providers/Microsoft.Authorization/roleAssignments/956a7efc-831e-735a-1f35-c48892476300",
            "name": "956a7efc-831e-735a-1f35-c48892476300",
            "principal_id": "fac1b65e-01d9-42af-8b71-979533d66f23",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/providers/Microsoft.Authorization/roleDefinitions/7f951dda-4ed3-4680-a7ca-43fe172d538d",
            "role_definition_name": "AcrPull",
            "scope": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.ContainerRegistry/registries/acrforakstf01357",
            "skip_service_principal_aad_check": true,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_resource_group.rg",
            "azurerm_user_assigned_identity.identity-kubelet",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_identity_aks_contributor",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.Authorization/roleAssignments/c697553d-db1b-a865-e85e-01a07cd724e0",
            "name": "c697553d-db1b-a865-e85e-01a07cd724e0",
            "principal_id": "52895521-ee58-43cd-8fd0-53ed09adaeca",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c",
            "role_definition_name": "Contributor",
            "scope": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-cluster",
            "skip_service_principal_aad_check": true,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_resource_group.rg",
            "azurerm_user_assigned_identity.identity_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_identity_aks_mi_operator",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.ManagedIdentity/userAssignedIdentities/identity-kubelet/providers/Microsoft.Authorization/roleAssignments/b2f5da26-543f-2790-224a-fc9b2ba22ecc",
            "name": "b2f5da26-543f-2790-224a-fc9b2ba22ecc",
            "principal_id": "52895521-ee58-43cd-8fd0-53ed09adaeca",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/providers/Microsoft.Authorization/roleDefinitions/f1a07417-d97a-45cb-824c-7a7467783830",
            "role_definition_name": "Managed Identity Operator",
            "scope": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.ManagedIdentity/userAssignedIdentities/identity-kubelet",
            "skip_service_principal_aad_check": true,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_resource_group.rg",
            "azurerm_user_assigned_identity.identity-kubelet",
            "azurerm_user_assigned_identity.identity_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_role_assignment",
      "name": "role_identity_aks_network_contributor",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "condition": "",
            "condition_version": "",
            "delegated_managed_identity_resource_id": "",
            "description": "",
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/providers/Microsoft.Authorization/roleAssignments/7b3d2491-8a08-a9b8-3410-7e1f5e4e095b",
            "name": "7b3d2491-8a08-a9b8-3410-7e1f5e4e095b",
            "principal_id": "52895521-ee58-43cd-8fd0-53ed09adaeca",
            "principal_type": "ServicePrincipal",
            "role_definition_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7",
            "role_definition_name": "Network Contributor",
            "scope": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks",
            "skip_service_principal_aad_check": true,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_resource_group.rg",
            "azurerm_user_assigned_identity.identity_aks",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_apiserver",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_nodes_user_nodepool",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "poolappsamd",
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.1.7.0/24"
            ],
            "delegation": [],
            "enforce_private_link_endpoint_network_policies": false,
            "enforce_private_link_service_network_policies": false,
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes-poolappsamd",
            "name": "subnet-nodes-poolappsamd",
            "private_endpoint_network_policies_enabled": true,
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "rg-lzaks-spoke-aks-infra",
            "service_endpoint_policy_ids": [],
            "service_endpoints": [],
            "timeouts": null,
            "virtual_network_name": "vnet-spoke-aks"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_pods_user_nodepool",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "poolappsamd",
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.1.8.0/24"
            ],
            "delegation": [
              {
                "name": "Microsoft.ContainerService.managedClusters",
                "service_delegation": [
                  {
                    "actions": [
                      "Microsoft.Network/virtualNetworks/subnets/join/action"
                    ],
                    "name": "Microsoft.ContainerService/managedClusters"
                  }
                ]
              }
            ],
            "enforce_private_link_endpoint_network_policies": false,
            "enforce_private_link_service_network_policies": false,
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods-poolappsamd",
            "name": "subnet-pods-poolappsamd",
            "private_endpoint_network_policies_enabled": true,
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "rg-lzaks-spoke-aks-infra",
            "service_endpoint_policy_ids": [],
            "service_endpoints": [],
            "timeouts": null,
            "virtual_network_name": "vnet-spoke-aks"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_system_nodes",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.1.3.0/24"
            ],
            "delegation": [],
            "enforce_private_link_endpoint_network_policies": false,
            "enforce_private_link_service_network_policies": false,
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes",
            "name": "subnet-nodes",
            "private_endpoint_network_policies_enabled": true,
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "rg-lzaks-spoke-aks-infra",
            "service_endpoint_policy_ids": [],
            "service_endpoints": [],
            "timeouts": null,
            "virtual_network_name": "vnet-spoke-aks"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet",
      "name": "subnet_system_pods",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "address_prefixes": [
              "10.1.240.0/20"
            ],
            "delegation": [
              {
                "name": "Microsoft.ContainerService.managedClusters",
                "service_delegation": [
                  {
                    "actions": [
                      "Microsoft.Network/virtualNetworks/subnets/join/action"
                    ],
                    "name": "Microsoft.ContainerService/managedClusters"
                  }
                ]
              }
            ],
            "enforce_private_link_endpoint_network_policies": false,
            "enforce_private_link_service_network_policies": false,
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods",
            "name": "subnet-pods",
            "private_endpoint_network_policies_enabled": true,
            "private_link_service_network_policies_enabled": true,
            "resource_group_name": "rg-lzaks-spoke-aks-infra",
            "service_endpoint_policy_ids": [],
            "service_endpoints": [],
            "timeouts": null,
            "virtual_network_name": "vnet-spoke-aks"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet_route_table_association",
      "name": "association_rt_subnet_system_nodes",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes",
            "route_table_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/routeTables/route-table-to-firewall",
            "subnet_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_subnet.subnet_system_nodes",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet_route_table_association",
      "name": "association_rt_subnet_system_pods",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods",
            "route_table_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/routeTables/route-table-to-firewall",
            "subnet_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_subnet.subnet_system_pods",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet_route_table_association",
      "name": "association_rt_subnet_user_nodes",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "poolappsamd",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes-poolappsamd",
            "route_table_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/routeTables/route-table-to-firewall",
            "subnet_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-nodes-poolappsamd",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_subnet.subnet_nodes_user_nodepool",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subnet_route_table_association",
      "name": "association_rt_subnet_user_pods",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "index_key": "poolappsamd",
          "schema_version": 0,
          "attributes": {
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods-poolappsamd",
            "route_table_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/routeTables/route-table-to-firewall",
            "subnet_id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-infra/providers/Microsoft.Network/virtualNetworks/vnet-spoke-aks/subnets/subnet-pods-poolappsamd",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_subnet.subnet_pods_user_nodepool",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_user_assigned_identity",
      "name": "identity-kubelet",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "client_id": "c7869b5a-b4ab-42ed-acd3-f90dae8688cf",
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.ManagedIdentity/userAssignedIdentities/identity-kubelet",
            "location": "westeurope",
            "name": "identity-kubelet",
            "principal_id": "fac1b65e-01d9-42af-8b71-979533d66f23",
            "resource_group_name": "rg-lzaks-spoke-aks-cluster",
            "tags": {
              "architecture": "Hub\u0026Spoke",
              "environment": "development",
              "source": "terraform"
            },
            "tenant_id": "16b3c013-d300-468d-ac64-7eda0820b6d3",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "azurerm_resource_group.rg"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_user_assigned_identity",
      "name": "identity_aks",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "client_id": "bb9e9bce-87a7-49bd-9b06-23ca5507b08e",
            "id": "/subscriptions/82f6d75e-85f4-434a-ab74-5dddd9fa8910/resourceGroups/rg-lzaks-spoke-aks-cluster/providers/Microsoft.ManagedIdentity/userAssignedIdentities/identity-aks",
            "location": "westeurope",
            "name": "identity-aks",
            "principal_id": "52895521-ee58-43cd-8fd0-53ed09adaeca",
            "resource_group_name": "rg-lzaks-spoke-aks-cluster",
            "tags": {
              "architecture": "Hub\u0026Spoke",
              "environment": "development",
              "source": "terraform"
            },
            "tenant_id": "16b3c013-d300-468d-ac64-7eda0820b6d3",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0=",
          "dependencies": [
            "azurerm_resource_group.rg"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "null_resource",
      "name": "connect_to_aks",
      "provider": "provider[\"registry.terraform.io/hashicorp/null\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "3813240601153300804",
            "triggers": {
              "key": "value2"
            }
          },
          "sensitive_attributes": [],
          "dependencies": [
            "azuread_group.aks_admins",
            "azurerm_kubernetes_cluster.aks",
            "azurerm_kubernetes_cluster_node_pool.poolapps",
            "azurerm_kubernetes_cluster_node_pool.poolspot",
            "azurerm_private_dns_zone.private_dns_zone_aks",
            "azurerm_resource_group.rg",
            "azurerm_subnet.subnet_apiserver",
            "azurerm_subnet.subnet_nodes_user_nodepool",
            "azurerm_subnet.subnet_nodes_user_nodepool_spot",
            "azurerm_subnet.subnet_pods_user_nodepool",
            "azurerm_subnet.subnet_pods_user_nodepool_spot",
            "azurerm_subnet.subnet_system_nodes",
            "azurerm_subnet.subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_system_pods",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_nodes",
            "azurerm_subnet_route_table_association.association_rt_subnet_user_pods",
            "azurerm_user_assigned_identity.identity-kubelet",
            "azurerm_user_assigned_identity.identity_aks",
            "data.azuread_client_config.current",
            "data.azurerm_subscription.subscription_spoke",
            "data.terraform_remote_state.management",
            "data.terraform_remote_state.spoke_aks"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
